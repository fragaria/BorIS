{% extends "print_base.html" %}
{% load i18n %}

{% block content_title %}<h1>{% block title %}{% trans "Registr uživatelů drog - žadatelů o léčbu" %} {{ q_no }}/{{ year }}{% endblock %}</h1>{% endblock %}


{% block extrastyle %}
    {{ block.super }}
    <style>
        body { padding: 0 20px; }
        table td { padding: 5px 5px; }
        table td.bold {
            font-weight: bold;
        }
        .anamnesis {
            margin-bottom: 200px;
        }
        .anamnesis .section {
            margin: 40px 0 10px;
            padding-left: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .row strong {
            margin-right: 30px;
        }
        .row span {
            font-weight: normal;
            margin-right: 30px;
        }
    </style>
{% endblock %}

{% block content %}
    {% for anamnesis in objects %}
        <div class="anamnesis">
            <p class="row">
                <strong>1. Léčebné kontaktní centrum</strong>
                <strong>Okres</strong>
                <strong>Číslo</strong>
                <strong>Kód</strong>
            </p>
            <p class="row">
                <strong>2. Kód klienta</strong> <span>{{ anamnesis.client.hygiene_report_code }}</span>
                <strong>Pohlaví</strong> <span>{% if anamnesis.client.sex == 'MALE' %}M{% else %}Ž{% endif %}</span>
                <strong>Okres bydliště</strong>
            </p>

            <p class="section">A. Charakter kontaktu</p>
            <p class="row">
                <strong>3. Datum žádosti o léčení</strong> <span>{# This value is added in view handling the report. #}{{ anamnesis.first_encounter_date|date:"DATE_FORMAT" }}</span>
            </p>
            <p class="row">
                <strong>4. Byl klient dříve léčen</strong> <span>{% if anamnesis.been_cured_before %}2. Ano{% else %}1. Ne{% endif %}</span>
            </p>
            <p class="row">
                <strong>5. Klient přichází na doporučení</strong> <span>0. Neuvedeno</span>
            </p>

            <p class="section">B. Socioekonomické údaje</p>
            <p class="row">
                <strong>6. V současné době klient žije</strong> <span>{{ anamnesis.accomodation }}. {{ anamnesis.get_accomodation_display }}</span>
            </p>
            <p class="row">
                <strong>7. Charakter bydlení</strong> <span>{{ anamnesis.living_condition }}. {{ anamnesis.get_living_condition_display }}</span>
            </p>
            <p class="row">
                <strong>8. Klient žije s osobou užívající drogy</strong> <span>{% if anamnesis.lives_with_junkies %}1. Ano{% else %}2. Ne{% endif %}</span>
            </p>
            <p class="row">
                <strong>9. Národnost</strong> <span>0. Nesledováno</span>
            </p>
            <p class="row">
                <strong>10. Státní příslušnost</strong> <span>{{ anamnesis.nationality }}. {{ anamnesis.get_nationality_display }}</span>
            </p>
            <p class="row">
                <strong>11. Zaměstnání</strong> <span>{{ anamnesis.employment }}. {{ anamnesis.get_employment_display }}</span>
            </p>
            <p class="row">
                <strong>12. Nejvyšší dosažené vzdělání</strong> <span>{{ anamnesis.education }}. {{ anamnesis.get_education_display }}</span>
            </p>

            <p class="section">C. Užívání drog</p>
            {% with anamnesis.drug_info as drugs %}
            <table>
                <tr>
                    <th></th>
                    <th>Druh</th>
                    <th>Aplikace</th>
                    <th>Četnost užívání za měsíc</th>
                    <th>Věk prvního užití</th>
                </tr>
                <tr>
                    <td class="bold">13. Základní droga</td>
                    <td>{{ drugs.0 }}</td>
                    <td>{{ drugs.0.application }}. {{ drugs.0.get_application_display }}</td>
                    <td>{{ drugs.0.frequency }}. {{ drugs.0.get_frequency_display }}</td>
                    <td>{{ drugs.0.first_try_age }}</td>
                </tr>
                {% if anamnesis.drugs.count > 1 %}
                <tr>
                    <td class="bold">14. Jiná droga 1</td>
                    <td>{{ drugs.1 }}</td>
                    <td>{{ drugs.1.application }}. {{ drugs.1.get_application_display }}</td>
                    <td>{{ drugs.1.frequency }}. {{ drugs.1.get_frequency_display }}</td>
                    <td>{{ drugs.1.first_try_age }}</td>
                </tr>
                {% endif %}
                {% if anamnesis.drugs.count > 2 %}
                <tr>
                    <td class="bold">15. Jiná droga 2</td>
                    <td>{{ drugs.2 }}</td>
                    <td>{{ drugs.2.application }}. {{ drugs.2.get_application_display }}</td>
                    <td>{{ drugs.2.frequency }}. {{ drugs.2.get_frequency_display }}</td>
                    <td>{{ drugs.2.first_try_age }}</td>
                </tr>
                {% endif %}
            </table>
            {% endwith %}
            <p class="row">
                <strong>16. Věk prvního užití jakékoliv drogy</strong> <span>{{ anamnesis.overall_first_try_age }}</span>
            </p>

            <p class="section">D. Rizikové chování</p>
            <p class="row">
                <strong>17. Injekční aplikace</strong>
            </p>
            <p class="row">
                <strong>18. Užívání společných stříkaček/jehel v posledním měsíci</strong>
            </p>
            <p class="row">
                <strong>19. Užívání kdykoliv v minulosti společné jehly</strong>
            </p>
            <p class="row">
                <strong>20. Věk prvního injekčního užití</strong> <span>{% if anamnesis.intravenous_first_try_age %}{{ anamnesis.intravenous_first_try_age }}{% else %}---{% endif %}</span>
            </p>
            <p class="row">
                {% with anamnesis.disease_test_results as tests %}
                    <strong>21. Vyšetření HIV a virové hepatitidy</strong>
                    <strong>HIV</strong> <span>{% if tests.HIV %}{{ tests.HIV.result }}. {{ tests.HIV.get_result_display }}{% else %}0. neznámo, zda testován{% endif %}</span>
                    <strong>VHA</strong> <span>{% if tests.VHA %}{{ tests.VHA.result }}. {{ tests.VHA.get_result_display }}{% else %}0. neznámo, zda testován{% endif %}</span>
                    <strong>VHB</strong> <span>{% if tests.VHB %}{{ tests.VHB.result }}. {{ tests.VHB.get_result_display }}{% else %}0. neznámo, zda testován{% endif %}</span>
                    <strong>VHC</strong> <span>{% if tests.VHC %}{{ tests.VHC.result }}. {{ tests.VHC.get_result_display }}{% else %}0. neznámo, zda testován{% endif %}</span>
                {% endwith %}
            </p>

            <p class="section">E. Průběžný závěr</p>
            <p class="row">
                <strong>22.</strong>
            </p>
        </div>
    {% endfor %}
{% endblock %}
